<UserControl x:Class="FlyleafLib.Controls.WPF.Flyleaf"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:local="clr-namespace:FlyleafLib.Controls.WPF"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             
             mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="600"
             Background="Transparent">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="MainDictionary.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <Style TargetType="local:Flyleaf">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="local:Flyleaf">
                            <ControlTemplate.Resources>
                                <ResourceDictionary>
                                    <Storyboard x:Key="fadeIn">
                                        <DoubleAnimation BeginTime="0:0:0" Storyboard.TargetProperty="Opacity"  To="1" Duration="0:0:0.5" AutoReverse="False"/>
                                    </Storyboard>

                                    <Storyboard x:Key="fadeOut">
                                        <DoubleAnimation BeginTime="0:0:0" Storyboard.TargetProperty="Opacity"  To="0" Duration="0:0:2.0" AutoReverse="False"/>
                                    </Storyboard>
                                </ResourceDictionary>
                            </ControlTemplate.Resources>
                            
                            <!--CONTENT HERE-->
                            <Grid x:Name="PART_ContextMenuOwner" ContextMenu="{StaticResource PopUpMenu}">

                                <!--Pop Up Dialog (Settings/Set Values)-->
                                <materialDesign:DialogHost x:Name="PART_DialogSettings" OverlayBackground="{x:Null}"/>
                                
                                <!-- Error Message -->
                                <TextBlock Margin="20" VerticalAlignment="top" HorizontalAlignment="Left" TextAlignment="Left" TextWrapping="Wrap" FontSize="16" Background="{Binding Config.Video.BackgroundColor, Converter={StaticResource ColorToBrush}}" Foreground="{DynamicResource PrimaryHueMidBrush}" FontWeight="Bold" Text="{Binding ErrorMsg}"/>

                                <!--Media Info-->
                                <TextBlock Margin="0 20 20 0" VerticalAlignment="top" HorizontalAlignment="Right" TextAlignment="Right" TextWrapping="Wrap" FontSize="16" Background="{Binding Config.Video.BackgroundColor, Converter={StaticResource ColorToBrush}}" Foreground="{DynamicResource PrimaryHueMidBrush}" FontWeight="Bold">
                                    <TextBlock.Style>
                                        <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource {x:Type TextBlock}}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ShowDebug}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat=" {0}p @{1} {2}/{3} [hw: {4}|{5}] &#x0d;&#x0a; [tbr: {6:#,#.00}] [vbr: {7:#,#.00}] [abr: {8:#,#.00}] &#x0d;&#x0a; [rec: {9}] [drops: {10}] [gpu: {11}]">
                                            <Binding Path="Player.Video.Height"/>
                                            <Binding Path="Player.Video.FPSCurrent"/>
                                            <Binding Path="Player.Video.Codec"/>
                                            <Binding Path="Player.Video.PixelFormat"/>
                                            <Binding Path="Config.Video.VideoAcceleration"/>
                                            <Binding Path="Player.Video.VideoAcceleration"/>
                                            <Binding Path="Player.BitRate"/>
                                            <Binding Path="Player.Video.BitRate"/>
                                            <Binding Path="Player.Audio.BitRate"/>
                                            <Binding Path="Player.IsRecording"/>
                                            <Binding Path="Player.Video.FramesDropped"/>
                                            <Binding Path="GPUUsage"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <!--Subtitles-->
                                <TextBlock x:Name="PART_Subtitles" Margin="0 0 0 50" VerticalAlignment="Bottom" HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap" FontSize="33" Foreground="White" FontWeight="Bold" Text="{Binding Player.Subtitles.SubsText}">
                                    <TextBlock.Effect>
                                        <DropShadowEffect ShadowDepth="2" Direction="0" Color="{Binding Config.Video.BackgroundColor}" Opacity="1.0" BlurRadius="0"/>
                                    </TextBlock.Effect>
                                </TextBlock>

                                <!--Flyleaf Bar-->
                                <materialDesign:Card TextElement.FontSize="14" TextElement.FontWeight="Medium" TextElement.Foreground="White" FontFamily="{materialDesign:MaterialDesignFont}" VerticalAlignment="Bottom" Focusable="False">
                                    <materialDesign:Card.Background>
                                        <SolidColorBrush Color="{Binding Config.Video.BackgroundColor}" Opacity="0.15"/>
                                    </materialDesign:Card.Background>
                                    <materialDesign:Card.Style>
                                        <Style TargetType="{x:Type materialDesign:Card}">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Player.Activity.Mode}" Value="Idle">
                                                    <DataTrigger.EnterActions>
                                                        <RemoveStoryboard BeginStoryboardName="fadeInN" />
                                                        <BeginStoryboard x:Name="fadeOutN" Storyboard="{StaticResource fadeOut}" />
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Player.Activity.Mode}" Value="FullActive">
                                                    <DataTrigger.EnterActions>
                                                        <RemoveStoryboard BeginStoryboardName="fadeOutN" />
                                                        <BeginStoryboard x:Name="fadeInN" Storyboard="{StaticResource fadeIn}" />
                                                    </DataTrigger.EnterActions>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </materialDesign:Card.Style>

                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>

                                        <Grid Margin="15,0,15,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!--Current Time | Slider | Duration-->
                                            <TextBlock Grid.Column="0" HorizontalAlignment="Left"   VerticalAlignment="Center" Text="{Binding Player.CurTime, Converter={StaticResource TicksToTime}}"/>
                                            <Slider    Grid.Column="1" IsSelectionRangeEnabled="True" SelectionStart="{Binding RelativeSource={RelativeSource Self}, Path=Value, Mode=OneWay}" Style="{DynamicResource FlyleafSlider}" Focusable="False" Margin="10,0,10,0" VerticalAlignment="Center" Value="{Binding Player.CurTime, Mode=TwoWay, Converter={StaticResource TicksToSeconds}}" Maximum="{Binding Player.Duration, Converter={StaticResource TicksToSeconds}}">
                                                <Slider.SelectionEnd>
                                                    <MultiBinding Converter="{StaticResource SumConverter}">
                                                        <Binding Path="SelectionStart" RelativeSource="{RelativeSource Self}" Mode="OneWay"/>
                                                        <Binding Path="Player.BufferedDuration" Converter="{StaticResource TicksToSeconds}" Mode="OneWay"/>
                                                    </MultiBinding>
                                                </Slider.SelectionEnd>
                                            </Slider>
                                            <TextBlock Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding Player.Duration, Converter={StaticResource TicksToTime}}"/>
                                        </Grid>

                                        <Grid Grid.Row="1" Margin="10,0,10,5">
                                            <Grid.Resources>
                                                <ResourceDictionary>
                                                    <Style x:Key="IconButton" TargetType="Button" BasedOn="{StaticResource MaterialDesignIconButton}">
                                                        <Setter Property="Width" Value="32"/>
                                                        <Setter Property="Height" Value="32"/>
                                                        <Setter Property="Focusable" Value="False"/>
                                                    </Style>
                                                </ResourceDictionary>
                                            </Grid.Resources>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="auto"/>
                                                <ColumnDefinition Width="auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!--Play / Pause Button-->
                                            <Button Grid.Column="0" Command="{Binding Player.Commands.TogglePlayPause}">
                                                <Button.Style>
                                                    <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                        <Setter Property="Content" Value="{materialDesign:PackIcon Kind=Play}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Player.Status}" Value="Playing">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=Pause}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                            <!--Subtitles Button (Currently not used)-->
                                            <Button Command="{Binding ShowSubtitlesMenu}" x:Name="PART_ContextMenuOwner_Subtitles" Grid.Column="1" Foreground="{DynamicResource SecondaryHueMidBrush}" Content="{materialDesign:PackIcon Kind=CcOutline}">
                                                <Button.Style>
                                                    <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                        <Setter Property="ContextMenu">
                                                            <Setter.Value>
                                                                <ContextMenu>
                                                                    <MenuItem Header="External" ItemsSource="{Binding Player.Subtitles.Plugins[OpenSubtitles].SubtitlesInputs}" AlternationCount="{Binding Player.Subtitles.Plugins[OpenSubtitles].SubtitlesInputs.Count}">
                                                                        <MenuItem.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                <Setter Property="IsCheckable" Value="True"/>
                                                                                <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                                <Setter Property="Header" Value="{Binding Url}"/>
                                                                            </Style>
                                                                        </MenuItem.ItemContainerStyle>
                                                                    </MenuItem>
                                                                    <MenuItem Header="Embedded" ItemsSource="{Binding Player.Subtitles.Streams}">
                                                                        <MenuItem.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                <Setter Property="IsCheckable" Value="True"/>
                                                                                <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                            </Style>
                                                                        </MenuItem.ItemContainerStyle>
                                                                        <MenuItem.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock>
                                                                                    <TextBlock.Text>
                                                                                        <MultiBinding StringFormat=" [#{0}] {1}">
                                                                                            <Binding Path="StreamIndex"/>
                                                                                            <Binding Path="Language"/>
                                                                                        </MultiBinding>
                                                                                    </TextBlock.Text>
                                                                                </TextBlock>
                                                                            </DataTemplate>
                                                                        </MenuItem.ItemTemplate>
                                                                    </MenuItem>
                                                                    <MenuItem Header="OpenSubtitles">
                                                                        <MenuItem.Style>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Value="False">
                                                                                        <DataTrigger.Binding>
                                                                                            <MultiBinding Converter="{StaticResource CheckNull}">
                                                                                                <Binding Path="Player.Subtitles.Plugins"/>
                                                                                                <Binding>
                                                                                                    <Binding.Source>
                                                                                                        <sys:String>OpenSubtitlesOrg</sys:String>
                                                                                                    </Binding.Source>
                                                                                                </Binding>
                                                                                            </MultiBinding>
                                                                                        </DataTrigger.Binding>
                                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                                        <Setter Property="ItemsSource" Value="{Binding Player.Subtitles.Plugins[OpenSubtitlesOrg].SubtitlesInputs}"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </MenuItem.Style>
                                                                        <MenuItem.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                <Setter Property="IsCheckable" Value="True"/>
                                                                                <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                            </Style>
                                                                        </MenuItem.ItemContainerStyle>
                                                                        <MenuItem.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock>
                                                                                    <TextBlock.Text>
                                                                                        <MultiBinding StringFormat=" ({0}) {1} {2}">
                                                                                            <Binding Path="Language"/>
                                                                                            <Binding Path="InputData.Rating"/>
                                                                                            <Binding Path="InputData.Title"/>
                                                                                        </MultiBinding>
                                                                                    </TextBlock.Text>
                                                                                </TextBlock>
                                                                            </DataTemplate>
                                                                        </MenuItem.ItemTemplate>
                                                                    </MenuItem>
                                                                    <MenuItem Header="YoutubeDL">
                                                                        <MenuItem.Style>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Value="False">
                                                                                        <DataTrigger.Binding>
                                                                                            <MultiBinding Converter="{StaticResource CheckNull}">
                                                                                                <Binding Path="Player.Audio.Plugins"/>
                                                                                                <Binding>
                                                                                                    <Binding.Source>
                                                                                                        <sys:String>YoutubeDL</sys:String>
                                                                                                    </Binding.Source>
                                                                                                </Binding>
                                                                                            </MultiBinding>
                                                                                        </DataTrigger.Binding>
                                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                                        <Setter Property="ItemsSource" Value="{Binding Player.Audio.Plugins[YoutubeDL].SubtitlesInputs}"/>
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </MenuItem.Style>
                                                                        <MenuItem.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                <Setter Property="IsCheckable" Value="True"/>
                                                                                <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                            </Style>
                                                                        </MenuItem.ItemContainerStyle>
                                                                        <MenuItem.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <TextBlock>
                                                                                    <TextBlock.Text>
                                                                                        <MultiBinding StringFormat=" [#{0}] {1}">
                                                                                            <Binding Path="Protocol"/>
                                                                                            <Binding Path="Language"/>
                                                                                        </MultiBinding>
                                                                                    </TextBlock.Text>
                                                                                </TextBlock>
                                                                            </DataTemplate>
                                                                        </MenuItem.ItemTemplate>
                                                                    </MenuItem>
                                                                </ContextMenu>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                            <!--Quality + Movies Title-->
                                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                                <Button x:Name="PART_ContextMenuOwner_Video" Command="{Binding ShowVideoMenu}">
                                                    <Button.Style>
                                                        <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                            <Setter Property="Content" Value=""/>
                                                            <Setter Property="ContextMenu">
                                                                <Setter.Value>
                                                                    <ContextMenu>
                                                                        <MenuItem Header="Embedded" ItemsSource="{Binding Player.Video.Streams}">
                                                                            <MenuItem.ItemContainerStyle>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                    <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                    <Setter Property="IsCheckable" Value="True"/>
                                                                                    <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                                </Style>
                                                                            </MenuItem.ItemContainerStyle>
                                                                            <MenuItem.ItemTemplate>
                                                                                <DataTemplate>
                                                                                    <TextBlock>
                                                                                        <TextBlock.Text>
                                                                                            <MultiBinding StringFormat=" {0}x{1} @{2:#,#.00} ({3}/{4})">
                                                                                                <Binding Path="Width"/>
                                                                                                <Binding Path="Height"/>
                                                                                                <Binding Path="FPS"/>
                                                                                                <Binding Path="Codec"/>
                                                                                                <Binding Path="PixelFormatStr"/>
                                                                                            </MultiBinding>
                                                                                        </TextBlock.Text>
                                                                                    </TextBlock>
                                                                                </DataTemplate>
                                                                            </MenuItem.ItemTemplate>
                                                                        </MenuItem>
                                                                        <MenuItem Header="External" ItemsSource="{Binding Player.Video.Plugins[OpenVideo].VideoInputs}" AlternationCount="{Binding Player.Video.Plugins[OpenVideo].VideoInputs.Count}">
                                                                            <MenuItem.ItemContainerStyle>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                    <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                    <Setter Property="IsCheckable" Value="True"/>
                                                                                    <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                                    <Setter Property="Header" Value="{Binding Url}"/>
                                                                                </Style>
                                                                            </MenuItem.ItemContainerStyle>
                                                                        </MenuItem>
                                                                        <MenuItem Header="BitSwarm">
                                                                            <MenuItem.Style>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                                    <Style.Triggers>
                                                                                        <DataTrigger Value="False">
                                                                                            <DataTrigger.Binding>
                                                                                                <MultiBinding Converter="{StaticResource CheckNull}">
                                                                                                    <Binding Path="Player.Video.Plugins"/>
                                                                                                    <Binding>
                                                                                                        <Binding.Source>
                                                                                                            <sys:String>BitSwarm</sys:String>
                                                                                                        </Binding.Source>
                                                                                                    </Binding>
                                                                                                </MultiBinding>
                                                                                            </DataTrigger.Binding>
                                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                                            <Setter Property="ItemsSource" Value="{Binding Player.Video.Plugins[BitSwarm].VideoInputs}"/>
                                                                                        </DataTrigger>
                                                                                    </Style.Triggers>
                                                                                </Style>
                                                                            </MenuItem.Style>
                                                                            <MenuItem.ItemContainerStyle>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                    <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                    <Setter Property="IsCheckable" Value="True"/>
                                                                                    <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                                    <Setter Property="Header" Value="{Binding InputData.Title}"/>
                                                                                </Style>
                                                                            </MenuItem.ItemContainerStyle>
                                                                        </MenuItem>
                                                                        <MenuItem Header="YoutubeDL">
                                                                            <MenuItem.Style>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                                    <Style.Triggers>
                                                                                        <DataTrigger Value="False">
                                                                                            <DataTrigger.Binding>
                                                                                                <MultiBinding Converter="{StaticResource CheckNull}">
                                                                                                    <Binding Path="Player.Video.Plugins"/>
                                                                                                    <Binding>
                                                                                                        <Binding.Source>
                                                                                                            <sys:String>YoutubeDL</sys:String>
                                                                                                        </Binding.Source>
                                                                                                    </Binding>
                                                                                                </MultiBinding>
                                                                                            </DataTrigger.Binding>
                                                                                            <Setter Property="Visibility" Value="Visible"/>
                                                                                            <Setter Property="ItemsSource" Value="{Binding Player.Video.Plugins[YoutubeDL].VideoInputs}"/>
                                                                                        </DataTrigger>
                                                                                    </Style.Triggers>
                                                                                </Style>
                                                                            </MenuItem.Style>
                                                                            <MenuItem.ItemContainerStyle>
                                                                                <Style TargetType="{x:Type MenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                                                    <Setter Property="Command" Value="{Binding DataContext.Player.Commands.Open, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"/>
                                                                                    <Setter Property="CommandParameter" Value="{Binding DataContext, RelativeSource={RelativeSource Self}}"/>
                                                                                    <Setter Property="IsCheckable" Value="True"/>
                                                                                    <Setter Property="IsChecked" Value="{Binding Enabled, Mode=OneWay}"/>
                                                                                </Style>
                                                                            </MenuItem.ItemContainerStyle>
                                                                            <MenuItem.ItemTemplate>
                                                                                <DataTemplate>
                                                                                    <TextBlock>
                                                                                        <TextBlock.Text>
                                                                                            <MultiBinding StringFormat=" {0}x{1} @{2} ({3}) [{4}] [Audio:{5}]">
                                                                                                <Binding Path="Width"/>
                                                                                                <Binding Path="Height"/>
                                                                                                <Binding Path="Fps"/>
                                                                                                <Binding Path="Codec"/>
                                                                                                <Binding Path="Protocol"/>
                                                                                                <Binding Path="HasAudio"/>
                                                                                            </MultiBinding>
                                                                                        </TextBlock.Text>
                                                                                    </TextBlock>
                                                                                </DataTemplate>
                                                                            </MenuItem.ItemTemplate>
                                                                        </MenuItem>
                                                                    </ContextMenu>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Player.Video.Height, Converter={StaticResource QualityToLevels}}" Value="Low">
                                                                    <Setter Property="Content" Value="{materialDesign:PackIcon Kind=QualityLow}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Player.Video.Height, Converter={StaticResource QualityToLevels}}" Value="Med">
                                                                    <Setter Property="Content" Value="{materialDesign:PackIcon Kind=QualityMedium}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Player.Video.Height, Converter={StaticResource QualityToLevels}}" Value="High">
                                                                    <Setter Property="Content" Value="{materialDesign:PackIcon Kind=QualityHigh}"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Player.Video.Height, Converter={StaticResource QualityToLevels}}" Value="_4K">
                                                                    <Setter Property="Content" Value="{materialDesign:PackIcon Kind=Video4kBox}"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Button Content="{materialDesign:PackIcon Kind=VideoInputAntenna}" Foreground="{DynamicResource SecondaryHueMidBrush}">
                                                    <Button.Style>
                                                        <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Player.IsLive}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <TextBlock VerticalAlignment="Center" FontStyle="Italic" Margin="5,0,0,0" Text="{Binding Player.Title}"/>
                                            </StackPanel>

                                            <!--Volume Button (Mute/Unmute)-->
                                            <Button Grid.Column="3" Foreground="{DynamicResource SecondaryHueMidBrush}" Command="{Binding Player.Commands.ToggleMute}">
                                                <Button.Style>
                                                    <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                        <Setter Property="Content" Value="{materialDesign:PackIcon Kind=VolumeHigh}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Player.Audio.Volume, Converter={StaticResource VolumeToLevels}}" Value="Mute">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=VolumeMute}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Player.Audio.Volume, Converter={StaticResource VolumeToLevels}}" Value="Low">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=VolumeLow}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Player.Audio.Volume, Converter={StaticResource VolumeToLevels}}" Value="Med">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=VolumeMedium}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Player.Audio.Mute}" Value="True">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=VolumeMute}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                            <!--Volume Slider (Decibel)-->
                                            <Slider Grid.Column="4" Style="{DynamicResource FlyleafSlider}" Foreground="{DynamicResource SecondaryHueMidBrush}" Focusable="False" Margin="0,0,6,6" Width="100" VerticalAlignment="Bottom" Minimum="0" Maximum="{Binding Config.Player.VolumeMax, Mode=OneWay}" Value="{Binding Player.Audio.Volume}"/>

                                            <!--Open Settings Button-->
                                            <Button Grid.Column="5" Style="{StaticResource IconButton}" Content="{materialDesign:PackIcon Kind=SettingsOutline}" Command="{Binding OpenSettings}"/>

                                            <!--Toggle Fullscreen Button-->
                                            <Button Grid.Column="6" Command="{Binding Player.Commands.ToggleFullScreen}">
                                                <Button.Style>
                                                    <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                        <Setter Property="Content" Value="{materialDesign:PackIcon Kind=Fullscreen}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Player.IsFullScreen}" Value="true">
                                                                <Setter Property="Content" Value="{materialDesign:PackIcon Kind=FullscreenExit}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                        </Grid>
                                    </Grid>
                                </materialDesign:Card>

                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </UserControl.Resources>



</UserControl>